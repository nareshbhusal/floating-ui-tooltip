!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("tslib"),require("@floating-ui/dom")):"function"==typeof define&&define.amd?define(["tslib","@floating-ui/dom"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["floating-ui-tooltip"]=e(t.tslib,t.dom)}(this,(function(t,e){"use strict";function i(t,e,i){var o=e+"EventListener";["transitionend","webkitTransitionEnd","oTransitionEnd"].forEach((function(e){t[o](e,i)}))}function o(t,e){t.setAttribute("data-transition-state",e),console.log(">> new transition state: "+e)}function n(t,e){t.setAttribute("data-state",e),Object.assign(t.style,{visibility:e})}function r(){return document.createElement("div")}function s(t){return{box:t.querySelector(".floating-ui-tooltip-box"),content:t.querySelector(".floating-ui-tooltip-content"),arrow:t.querySelector(".floating-ui-tooltip-arrow")||void 0}}function a(t,e){var r=t._instance,s=t.getAttribute("data-transition-state");if(console.log("``````````"),console.log("\n"),console.log(e,s),"visible"===e){if("shown"===s||"showing"===s)return void console.log("already "+s);if("hidden"===s)console.log("showing"),o(t,"showing");else if("hiding"===s)return void console.log("cancelling "+s)}else{if("hidden"===s||"hiding"===s)return void console.log("already "+s);if("shown"===s)o(t,"hiding"),r.props.onHide(r);else if("showing"===s)return void console.log("cancelling "+s)}var a="visible"===e?"shown":"hidden";0!==r.transitionDuration?(!function(t,e){function o(n){if(n.target===t){i(t,"remove",o);try{e()}catch(e){console.error(e),t._instance.props.onHide()}}}i(t,"remove",o),i(t,"add",o)}(t,(function(){!function(t,e){t._instance.setState({isShown:"visible"===e})}(t,e),o(t,a),"visible"===e&&r.props.onShow(r)})),n(t,e)):(n(t,e),o(t,a),"visible"===e&&r.props.onShow(r))}var l={top:"bottom",right:"left",bottom:"top",left:"right"},c=function(i){var o=i.passedPlacement,n=i.passedOffset,r=i.resetPlacementOnUpdate,s=i.newlyShown,a=i.toShift,l=i.toShowArrow,c=i.arrowElement,d=i.tooltipElement,p=i.target;return t.__awaiter(void 0,void 0,void 0,(function(){var i,u,h,f;return t.__generator(this,(function(g){switch(g.label){case 0:return i=function(t){var e=t.passedPlacement,i=t.fui,o=t.newlyShown,n=e.position,r=e.orientation;if(!i||!o)return n;var s=i.x,a=i.y;return(s<0||a<0)&&"auto"===r?"auto":n}({passedPlacement:o,fui:d._instance.state.fui,newlyShown:s}),console.log("fui is:"),console.log(d._instance.state.fui),console.log("position now should be "+i),u="auto"===i&&(s||r),h=a&&s,f=t.__assign(t.__assign({},"auto"!==i&&{placement:i}),{middleware:t.__spreadArray(t.__spreadArray(t.__spreadArray(t.__spreadArray([e.offset({mainAxis:n[0],crossAxis:n[1]})],u?[e.autoPlacement()]:[],!0),h?[e.shift({padding:16})]:[],!0),l?[e.arrow({element:c,padding:2})]:[],!0),[e.size({apply:function(t){t.width,t.height,t.reference,t.floating}}),e.hide()],!1)}),[4,e.computePosition(p,d,f)];case 1:return[2,g.sent()]}}))}))},d=function(e,i,o,n,r,d){return t.__awaiter(void 0,void 0,void 0,(function(){var p,u,h,f,g,w,b,v,m,x,_,y,S,E,O,k,C,T,H,D,A,L,P,z,U,R,j,I,q,M;return t.__generator(this,(function(t){switch(t.label){case 0:return u=void 0===(p={}.toShift)||p,h=e.placement,f=e.hideOnReferenceHidden,g=e.offset,w=e.hideOnTooltipEscape,b=e.arrowSizeScale,v=e.resetPlacementOnUpdate,m=e.arrow,x=e.scrollIntoView,_=e.showOnCreate,y=s(i).arrow,o?[4,c({passedPlacement:h,passedOffset:g,resetPlacementOnUpdate:v,toShift:u,toShowArrow:m,arrowElement:y,tooltipElement:i,target:o,newlyShown:r})]:[2];case 1:return S=t.sent(),r?(console.log("---"),console.log("refiring computePosition because it's newlyshown"),[4,c({passedPlacement:h,passedOffset:g,resetPlacementOnUpdate:v,toShift:u,toShowArrow:m,arrowElement:y,tooltipElement:i,target:o,newlyShown:r})]):[3,3];case 2:S=t.sent(),console.log("fui is:"),console.log(i._instance.state.fui),console.log("---"),t.label=3;case 3:switch(E=S.x,O=S.y,k=S.placement,C=S.middlewareData,T=C.hide,H=T.referenceHidden,D=T.escaped,H&&r&&x&&o.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),C.arrow&&(A=C.arrow.x,L=C.arrow.y),P=0!==C.arrow.centerOffset,z=f&&H||w&&D||n?"hidden":"visible",console.log("to change visibility to: "+z),"visible"===z&&r&&!_&&(z="hidden"),a(i,z),Object.assign(i.style,{left:E+"px",top:O+"px"}),U=12*b,R=l[k.split("-")[0]],j=0,I=0,q=0,q=null!==A?A+U+"px":"",R){case"top":j=1/1.7,q=null!==A?A+U*j+"px":"";break;case"bottom":j=.5,q=null!==A?A+U*j+"px":"";break;case"left":j=.005,q=null!==A?A+"px":"",I=null!==L?L-U*j/2+"px":"";break;case"right":j=1.2,q=null!==A?A+"px":"",I=null!==L?L-U*j/2+"px":""}return I=null!==L?L-U*j/2+"px":"",I=null!==L?L+"px":"",Object.assign(y.style,((M={visibility:P?"hidden":"visible",left:q,top:I,right:"",bottom:""})[R]="-"+U*j+"px",M)),d({fui:S}),[2,S]}}))}))},p={allowHTML:!0,content:"",arrow:!0,scrollIntoView:!1,transitionDuration:[300,250],offset:[10,0],hideOnClick:!0,onClickOutside:function(t,e){},onShow:function(t){},onHide:function(t){},onStateChange:function(t,e){},onRemove:function(){},onBeforeFirstRender:function(){},placement:{position:"top",orientation:"fixed"},resetPlacementOnUpdate:!1,hideOnTooltipEscape:!0,hideOnReferenceHidden:!0,showOnCreate:!0,maxWidth:350,updateDebounce:100,zIndex:99999,arrowSizeScale:1,updateOnEvents:"resize scroll"};var u=function(){function i(t,e){var i,o=this;this.state={isShown:!1,isRemoved:!1,fui:void 0},this.updateListenerCleanup=function(){},this.toHideTooltip=!1,this.transitionDuration=0,this.clickHandler=function(t){o.state.isShown&&(o.tooltipElement.contains(t.target)||o.reference.contains(t.target)||o.props.onClickOutside&&o.props.onClickOutside(o,t),"target"===o.props.hideOnClick?t.target===o.reference&&o.hide():o.props.hideOnClick&&o.hide())},this.props=t,this.reference=e,(i=document.createElement("style")).type="text/css",i.setAttribute("floating-ui-tooltip-default",""),i.textContent=".floating-ui-tooltip-root{--color:#fff;--border-color:#fefefe;--border-color:red;backface-visibility:hidden;background:var(--color);border-radius:6px;box-shadow:0 0 0 1px rgba(6,44,82,.1),0 2px 16px rgba(33,43,54,.08);box-shadow:0 0 20px 4px rgba(154,161,177,.15),0 4px 80px -8px rgba(36,40,47,.25),0 4px 4px -2px rgba(91,94,105,.15);display:flex;font-size:90%;line-height:0px;margin:0;max-width:calc(100vw - 10px);padding:0;position:absolute;transition-duration:.2s;transition-property:transform,visibility,opacity;transition-timing-function:cubic-bezier(.54,1.5,.38,1.11);z-index:9999}.floating-ui-tooltip-arrow{box-shadow:0 0 0 1px rgba(6,44,82,.1),0 2px 16px rgba(33,43,54,.08);height:14px;position:absolute;transform:translateX(-50%) rotate(45deg);width:14px;z-index:-1}.floating-ui-tooltip-box{border-radius:inherit;line-height:normal;margin:0;outline:0;position:relative}.floating-ui-tooltip-root[data-state=hidden]{opacity:0}.floating-ui-tooltip-root[data-state=visible]{opacity:1}.floating-ui-tooltip-content{background-color:#fff;border-radius:inherit;color:#111;padding:0;position:relative;z-index:2}.floating-ui-tooltip-arrow,.floating-ui-tooltip-root{background:var(--color)}",document.head.appendChild(i),this.toHideTooltip=!this.props.showOnCreate}return i.prototype.hookEventListeners=function(){var t,i,o,n=this;this.debouncedUpdate=(t=this.update.bind(this),0===(i=this.props.updateDebounce)?t:function(e){clearTimeout(o),o=setTimeout((function(){t(e)}),i)});var r=e.autoUpdate(this.reference,this.tooltipElement,(function(){return n.debouncedUpdate(void 0)})),s=function(){return n.debouncedUpdate(void 0)};this.props.updateOnEvents.split(" ").forEach((function(t){window.addEventListener(t,s)})),window.addEventListener("click",this.clickHandler.bind(this)),this.updateListenerCleanup=function(){r(),window.removeEventListener("click",n.clickHandler.bind(n)),n.props.updateOnEvents.split(" ").forEach((function(t){window.removeEventListener(t,s)}))}},i.prototype.updateTransitionDuration=function(t){this.transitionDuration=t,this.tooltipElement.style.transitionDuration=t+"ms"},i.prototype.create=function(){return t.__awaiter(this,void 0,void 0,(function(){var e,i,a,l,c,p,u=this;return t.__generator(this,(function(h){switch(h.label){case 0:return e=!this.props.showOnCreate,this.tooltipElement=(f=this,g=r(),w=r(),b=r(),v=r(),g.className="floating-ui-tooltip-root",w.className="floating-ui-tooltip-box",b.className="floating-ui-tooltip-content",v.className="floating-ui-tooltip-arrow",w.appendChild(b),w.appendChild(v),g.appendChild(w),Object.assign(b.style,{maxWidth:f.props.maxWidth+"px"}),b.innerHTML='\n    <div id="tooltip-container">\n    <h3>Default tooltip</h3>\n    </div>\n  ',w.setAttribute("role","tooltip"),n(g,"hidden"),o(g,"hidden"),Object.assign(g.style,{zIndex:f.props.zIndex,visibility:"hidden",left:"0px",top:"0px"}),g._instance=f,g),this.updateTransitionDuration(this.props.transitionDuration[e?0:1]),i=s(this.tooltipElement).content,a=this.props,l=a.allowHTML,c=a.content,l?i.innerHTML=c:i.innerText=""+c,document.body.appendChild(this.tooltipElement),p=function(){return t.__awaiter(u,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return[4,d(this.props,this.tooltipElement,this.reference,e,!0,this.setState.bind(this))];case 1:return t.sent(),this.hookEventListeners(),[2]}}))}))},this.props.onBeforeFirstRender(),[4,p()];case 1:return h.sent(),[2]}var f,g,w,b,v}))}))},i.prototype.getState=function(){return this.state},i.prototype.setState=function(e){void 0!==e.isShown&&e.isShown!==this.state.isShown&&this.updateTransitionDuration(this.props.transitionDuration[e.isShown?1:0]),this.props.onStateChange(this.state,e),this.state=t.__assign(t.__assign({},this.state),e)},i.prototype.update=function(e){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return e=e||this.toHideTooltip||!1,[4,d(this.props,this.tooltipElement,this.reference,e,!1,this.setState.bind(this))];case 1:return t.sent(),[2]}}))}))},i.prototype.hide=function(){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return this.toHideTooltip=!0,[4,this.update(!0)];case 1:return t.sent(),[2]}}))}))},i.prototype.show=function(){return t.__awaiter(this,void 0,void 0,(function(){return t.__generator(this,(function(t){switch(t.label){case 0:return this.toHideTooltip=!1,[4,this.update(!1)];case 1:return t.sent(),[2]}}))}))},i.prototype.remove=function(){this.tooltipElement.remove(),this.state={isShown:!1,isRemoved:!0,fui:void 0},this.updateListenerCleanup(),console.log("removed all event listeners and observers"),this.props.onRemove()},i}();return function(e,i){return t.__awaiter(this,void 0,void 0,(function(){var o,n,r,s,a;return t.__generator(this,(function(l){switch(l.label){case 0:return o=i.placement||p.placement,n=i.transitionDuration||p.transitionDuration,r=i.offset||p.offset,Object.keys(i).forEach((function(t){return void 0===i[t]&&delete i[t]})),s=t.__assign(t.__assign(t.__assign({},p),i),{placement:o,transitionDuration:n,offset:r}),[4,(a=new u(s,e)).create()];case 1:return l.sent(),[2,{props:a.props,reference:a.reference,tooltipElement:a.tooltipElement,getState:a.getState.bind(a),show:a.show.bind(a),hide:a.hide.bind(a),remove:a.remove.bind(a),update:a.update.bind(a)}]}}))}))}}));
//# sourceMappingURL=index.js.map
