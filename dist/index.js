!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("tslib"),require("@floating-ui/dom")):"function"==typeof define&&define.amd?define(["exports","tslib","@floating-ui/dom"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["floating-ui-tooltip"]={},t.tslib,t.dom)}(this,(function(t,e,i){"use strict";function n(t,e,i){var n=e+"EventListener";["transitionend","webkitTransitionEnd","oTransitionEnd"].forEach((function(e){t[n](e,i)}))}function o(t,e){t.setAttribute("data-transition-state",e)}function r(t,e){t.setAttribute("data-state",e),Object.assign(t.style,{visibility:e})}function s(){return document.createElement("div")}function a(t){return{box:t.querySelector(".floating-ui-tooltip-box"),content:t.querySelector(".floating-ui-tooltip-content"),arrow:t.querySelector(".floating-ui-tooltip-arrow")||void 0}}var l,d=function(t,e,i){var n=i||100;clearTimeout(l),l=setTimeout((function(){p(t,e)}),n)};function p(t,e){!function(t){clearTimeout(t)}(l);var i=t._instance,s=i.props.updateDebounce,a=t.getAttribute("data-transition-state");if("visible"===e){if("shown"===a||"showing"===a)return;if("hidden"===a)o(t,"showing");else if("hiding"===a)return void d(t,e,s)}else{if("hidden"===a||"hiding"===a)return;if("shown"===a)o(t,"hiding"),i.props.onHide(i);else if("showing"===a)return void d(t,e,s)}var p="visible"===e?"shown":"hidden";0!==i.transitionDuration?(!function(t,e){function i(o){if(o.target===t){n(t,"remove",i);try{e()}catch(e){console.error(e),t._instance.props.onHide()}}}n(t,"remove",i),n(t,"add",i)}(t,(function(){!function(t,e){t._instance.setState({isShown:"visible"===e})}(t,e),o(t,p),"visible"===e&&i.props.onShow(i)})),r(t,e)):(r(t,e),o(t,p),"visible"===e&&i.props.onShow(i))}var c={top:"bottom",right:"left",bottom:"top",left:"right"},u=function(t){var e,i,n,o=t.passedPlacement,r=t.tooltipElement,s=t.toResetPosition,a=o.orientation,l=null===(e=r._instance.state.fui)||void 0===e?void 0:e.placement;return l?s?(i=r.getBoundingClientRect(),n=document.documentElement.getBoundingClientRect(),(i.top<n.top||i.bottom>n.bottom||i.left<n.left||i.right>n.right)&&(console.log("tooltip overflown"),"auto"===a)?"auto":l):l:o.position},h=function(t){var n=t.passedPlacement,o=t.toResetPosition,r=t.passedOffset,s=t.resetPlacementOnUpdate,a=t.newlyShown,l=t.toShift,d=t.toShowArrow,p=t.arrowElement,c=t.tooltipElement,h=t.target;return e.__awaiter(void 0,void 0,void 0,(function(){var t,f,w,g;return e.__generator(this,(function(m){switch(m.label){case 0:return t=u({passedPlacement:n,tooltipElement:c,toResetPosition:o}),f="auto"===t&&(a||s),w=l&&a,g=e.__assign(e.__assign({},"auto"!==t&&{placement:t}),{middleware:e.__spreadArray(e.__spreadArray(e.__spreadArray(e.__spreadArray([i.offset({mainAxis:r[0],crossAxis:r[1]})],f?[i.autoPlacement()]:[],!0),w?[i.shift({padding:16})]:[],!0),d?[i.arrow({element:p,padding:2})]:[],!0),[i.size({apply:function(t){t.width,t.height,t.reference,t.floating}}),i.hide()],!1)}),[4,i.computePosition(h,c,g)];case 1:return[2,m.sent()]}}))}))},f=function(t,i,n,o,r,s){return e.__awaiter(void 0,void 0,void 0,(function(){var l,d,u,f,w,g,m,v,b,x,_,y,E,S;return e.__generator(this,(function(e){switch(e.label){case 0:return d=void 0===(l={}.toShift)||l,u=t.placement,f=t.hideOnReferenceHidden,w=t.offset,g=t.hideOnTooltipEscape,m=t.arrowSizeScale,v=t.resetPlacementOnUpdate,b=t.arrow,x=t.scrollIntoView,_=t.showOnCreate,y=a(i).arrow,E=!i._instance.getState().fui,n?[4,h({passedPlacement:u,toResetPosition:r,passedOffset:w,resetPlacementOnUpdate:v,toShift:d,toShowArrow:b,arrowElement:y,tooltipElement:i,target:n,newlyShown:E})]:[2,console.warn("target element not found")];case 1:return function(t){var e,i,n,o=t.fui,r=t.newlyShown,s=t.scrollIntoView,a=t.hideOnReferenceHidden,l=t.hideOnTooltipEscape,d=t.tooltipElement,u=t.arrowElement,h=t.target,f=t.toHide,w=t.showOnCreate,g=t.arrowSizeScale,m=o.x,v=o.y,b=o.placement,x=o.middlewareData,_=x.hide,y=_.referenceHidden,E=_.escaped;y&&r&&s&&h.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),x.arrow&&(i=x.arrow.x,n=x.arrow.y);var S=0!==x.arrow.centerOffset,O=a&&y||l&&E||f?"hidden":"visible";"visible"===O&&r&&!w&&(O="hidden"),p(d,O),Object.assign(d.style,{left:m+"px",top:v+"px"});var T=12*g,C=c[b.split("-")[0]],k=0,H=0,A=0;switch(A=null!==i?i+T+"px":"",C){case"top":k=1/1.7,k=.5,A=null!==i?i+T*k+"px":"";break;case"bottom":k=.5,A=null!==i?i+T*k+"px":"";break;case"left":k=.005,A=null!==i?i+"px":"",H=null!==n?n-T*k/2+"px":"";break;case"right":k=1,A=null!==i?i+"px":"",H=null!==n?n-T*k/2+"px":""}H=null!==n?n-T*k/2+"px":"",H=null!==n?n+"px":"",Object.assign(u.style,((e={visibility:S?"hidden":"visible",left:A,top:H,right:"",bottom:"",width:T+"px",height:T+"px"})[C]="-"+T*k+"px",e))}({fui:S=e.sent(),newlyShown:E,scrollIntoView:x,hideOnReferenceHidden:f,hideOnTooltipEscape:g,tooltipElement:i,arrowElement:y,target:n,toHide:o,showOnCreate:_,arrowSizeScale:m}),s({fui:S}),[2,S]}}))}))},w={allowHTML:!0,content:"",arrow:!0,scrollIntoView:!1,transitionDuration:[300,250],offset:[0,0],factorArrowInOffset:!0,hideOnClick:!0,onClickOutside:function(t,e){},onShow:function(t){},onHide:function(t){},onStateChange:function(t,e){},onRemove:function(){},onBeforeFirstRender:function(){},onAfterFirstRender:function(){},placement:{position:"top",orientation:"fixed"},resetPlacementOnUpdate:!1,hideOnTooltipEscape:!0,hideOnReferenceHidden:!0,showOnCreate:!0,maxWidth:350,updateDebounce:100,zIndex:99999,arrowSizeScale:1,updateOnEvents:"resize scroll"};var g=function(){function t(t,e){var i,n=this;this.state={isShown:!1,isRemoved:!1,fui:void 0},this.updateListenerCleanup=function(){},this.toHideTooltip=!1,this.transitionDuration=0,this.clickHandler=function(t){n.state.isShown&&(n.tooltipElement.contains(t.target)||n.reference.contains(t.target)||n.props.onClickOutside&&n.props.onClickOutside(n,t),"target"===n.props.hideOnClick?t.target===n.reference&&n.hide():n.props.hideOnClick&&n.hide())},this.props=t,this.reference=e,window.tp=this,(i=document.createElement("style")).type="text/css",i.setAttribute("floating-ui-tooltip-default",""),i.textContent=".floating-ui-tooltip-root{--color:#fff;--border-color:#fefefe;--border-color:red;backface-visibility:hidden;background:var(--color);border-radius:6px;box-shadow:0 0 0 1px rgba(6,44,82,.1),0 2px 16px rgba(33,43,54,.08);box-shadow:0 0 20px 4px rgba(154,161,177,.15),0 4px 80px -8px rgba(36,40,47,.25),0 4px 4px -2px rgba(91,94,105,.15);display:flex;font-size:90%;line-height:0px;margin:0;max-width:calc(100vw - 10px);padding:0;position:absolute;transition-duration:.2s;transition-property:transform,visibility,opacity;transition-timing-function:cubic-bezier(.54,1.5,.38,1.11);z-index:9999}.floating-ui-tooltip-arrow{box-shadow:0 0 0 1px rgba(6,44,82,.1),0 2px 16px rgba(33,43,54,.08);height:14px;position:absolute;transform:translateX(-50%) rotate(45deg);width:14px;z-index:-1}.floating-ui-tooltip-box{border-radius:inherit;line-height:normal;margin:0;outline:0;position:relative}.floating-ui-tooltip-root[data-state=hidden]{opacity:0}.floating-ui-tooltip-root[data-state=visible]{opacity:1}.floating-ui-tooltip-content{background-color:#fff;border-radius:inherit;color:#111;padding:0;position:relative;z-index:2}.floating-ui-tooltip-arrow,.floating-ui-tooltip-root{background:var(--color)}",document.head.appendChild(i),this.toHideTooltip=!this.props.showOnCreate}return t.prototype.hookEventListeners=function(){var t=this;this.debouncedUpdate=function(t,e){return 0===e?t:function(n){clearTimeout(i),i=setTimeout((function(){t(n)}),e)};var i}(this.update.bind(this),this.props.updateDebounce);var e=i.autoUpdate(this.reference,this.tooltipElement,(function(){return t.debouncedUpdate(void 0)})),n=function(){return t.debouncedUpdate(void 0)};this.props.updateOnEvents.split(" ").forEach((function(t){window.addEventListener(t,n)})),window.addEventListener("click",this.clickHandler.bind(this)),this.updateListenerCleanup=function(){e(),window.removeEventListener("click",t.clickHandler.bind(t)),t.props.updateOnEvents.split(" ").forEach((function(t){window.removeEventListener(t,n)}))}},t.prototype.updateTransitionDuration=function(t){this.transitionDuration=t,this.tooltipElement.style.transitionDuration=t+"ms"},t.prototype.create=function(){return e.__awaiter(this,void 0,void 0,(function(){var t,i,n,l,d,p=this;return e.__generator(this,(function(c){switch(c.label){case 0:return this.tooltipElement=(u=this,h=s(),w=s(),g=s(),m=s(),h.className="floating-ui-tooltip-root",w.className="floating-ui-tooltip-box",g.className="floating-ui-tooltip-content",m.className="floating-ui-tooltip-arrow",w.appendChild(g),w.appendChild(m),h.appendChild(w),Object.assign(g.style,{maxWidth:u.props.maxWidth+"px"}),w.setAttribute("role","tooltip"),r(h,"hidden"),o(h,"hidden"),Object.assign(h.style,{zIndex:u.props.zIndex,visibility:"hidden",left:"0px",top:"0px"}),h._instance=u,h),this.updateTransitionDuration(this.props.transitionDuration[this.toHideTooltip?0:1]),t=a(this.tooltipElement).content,i=this.props,n=i.allowHTML,l=i.content,n?l instanceof Element?t.appendChild(l):t.innerHTML=l:l instanceof Element||(t.innerText=l),document.body.appendChild(this.tooltipElement),this.props.onBeforeFirstRender(),d=function(){return e.__awaiter(p,void 0,void 0,(function(){return e.__generator(this,(function(t){switch(t.label){case 0:return[4,f(this.props,this.tooltipElement,this.reference,this.toHideTooltip,!0,this.setState.bind(this))];case 1:case 2:return t.sent(),[4,this.update(!1,!0)];case 3:return t.sent(),this.hookEventListeners(),[2]}}))}))},[4,d()];case 1:return c.sent(),this.props.showOnCreate?[4,this.show()]:[3,3];case 2:return c.sent(),[3,5];case 3:return[4,this.hide()];case 4:c.sent(),c.label=5;case 5:return this.props.onAfterFirstRender(),[2]}var u,h,w,g,m}))}))},t.prototype.getState=function(){return this.state},t.prototype.setState=function(t){void 0!==t.isShown&&t.isShown!==this.state.isShown&&this.updateTransitionDuration(this.props.transitionDuration[t.isShown?1:0]),this.props.onStateChange(this.state,t),this.state=e.__assign(e.__assign({},this.state),t)},t.prototype.update=function(t,i){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return t=t||this.toHideTooltip||!1,[4,f(this.props,this.tooltipElement,this.reference,t,i,this.setState.bind(this))];case 1:return e.sent(),[2]}}))}))},t.prototype.hide=function(){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(t){switch(t.label){case 0:return this.toHideTooltip=!0,[4,this.update(!0)];case 1:return t.sent(),[2]}}))}))},t.prototype.show=function(){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(t){switch(t.label){case 0:return this.toHideTooltip=!1,[4,this.update(!1)];case 1:return t.sent(),[2]}}))}))},t.prototype.remove=function(){this.tooltipElement.remove(),this.state={isShown:!1,isRemoved:!0,fui:void 0},this.updateListenerCleanup(),console.log("removed all event listeners and observers"),this.props.onRemove()},t}();t.DEFAULT_ARROW_SIZE=12,t.default=function(t,i){return e.__awaiter(this,void 0,void 0,(function(){var n,o,r,s,a,l;return e.__generator(this,(function(d){switch(d.label){case 0:return n=i.placement||w.placement,o=i.transitionDuration||w.transitionDuration,r=i.offset||w.offset,Object.keys(i).forEach((function(t){return void 0===i[t]&&delete i[t]})),(s=e.__assign(e.__assign(e.__assign({},w),i),{placement:n,transitionDuration:o,offset:r})).factorArrowInOffset=s.arrow&&s.factorArrowInOffset,s.factorArrowInOffset&&(a=12*s.arrowSizeScale,s.offset[0]=s.offset[0]+a*Math.sqrt(2)/2),[4,(l=new g(s,t)).create()];case 1:return d.sent(),[2,{props:l.props,reference:l.reference,tooltipElement:l.tooltipElement,getState:l.getState.bind(l),show:l.show.bind(l),hide:l.hide.bind(l),remove:l.remove.bind(l),update:l.update.bind(l)}]}}))}))},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=index.js.map
